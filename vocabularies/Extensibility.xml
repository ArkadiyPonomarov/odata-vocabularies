<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.01">
  <edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Core.V1.xml">
    <edmx:Include Alias="Core" Namespace="Org.OData.Core.V1" />
  </edmx:Reference>
  <edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Validation.V1.xml">
    <edmx:Include Alias="Validation" Namespace="Org.OData.Validation.V1" />
  </edmx:Reference>
  <edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/Common.xml">
    <edmx:Include Namespace="com.sap.vocabularies.Common.v1" Alias="Common" />
  </edmx:Reference>

  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="com.sap.vocabularies.Extensibility.v1" Alias="Extensibility">
      <Annotation Term="Common.Experimental" />
      <Annotation Term="Core.Description">
        <String>
          Terms for Extensibility to tell consumers which extensibility features and capabilities are available on service and entity level.
        </String>
      </Annotation>
      <Annotation Term="Core.Description" Qualifier="Published">
        <String>2021-10-04 Â© Copyright 2021 SAP SE. All rights reserved</String>
      </Annotation>
      <Annotation Term="Core.Links">
        <Collection>
          <Record>
            <PropertyValue Property="rel" String="latest-version" />
            <PropertyValue Property="href" String="https://sap.github.io/odata-vocabularies/vocabularies/Extensibility.xml" />
          </Record>
          <Record>
            <PropertyValue Property="rel" String="alternate" />
            <PropertyValue Property="href" String="https://sap.github.io/odata-vocabularies/vocabularies/Extensibility.json" />
          </Record>
          <Record>
            <PropertyValue Property="rel" String="describedby" />
            <PropertyValue Property="href" String="https://github.com/sap/odata-vocabularies/blob/main/vocabularies/Extensibility.md" />
          </Record>
        </Collection>
      </Annotation>
      <!-- short cut annotation -->
      <Term Name="Extensible" Type="Core.Tag" Nullable="false" DefaultValue="false" AppliesTo="EntityType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description">
          <String>
            The annotated entity type allows all extensibility features the server provides. In case the entity is annotated with the more 
            detailed @Extensibility.Fields, @Extensibility.Relations, @Extensibility.Annotations annotation, this annotation should be ignored.

            Exposing an entity using this annotation establishes a very broad extensibility contract. Only very limited changes to the entity
            can be considered compatible so that extensions will survive updates.
          </String>
        </Annotation> 
      </Term>
      <!-- Fine grained, more detailed annotations, if they are present the short cut Extensibility.Extenible is ignored -->
      <Term Name="Fields" Type="Extensibility.FieldsType" AppliesTo="EntityType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="The annotated entity type has the specified field extension capabilities" />
      </Term>

      <ComplexType Name="FieldsType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="The annotated entity type has the specified field extension capabilities" />
        <Property Name="Enabled" Type="Core.Tag" Nullable="false" DefaultValue="false">
          <Annotation Term="Common.Experimental" />
          <Annotation Term="Core.Description" String="Allows to extend the entity with additional attributes and annotations for these extension attribute. The presence of this annotation means the @Extensibility.Extensible annotation must be ignored." />
        </Property>
      </ComplexType>

      <Term Name="Relations" Type="Extensibility.RelationsType" AppliesTo="EntityType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="The annotated entity type has the specified relational extension capabilities" />
      </Term>

      <ComplexType Name="RelationsType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="Enable fine grained extensibility features" />
        <Property Name="Enabled" Type="Core.Tag" Nullable="false" DefaultValue="false">
          <Annotation Term="Common.Experimental" />
          <Annotation Term="Core.Description" String="Allows to extend the entity with additional compositions, also called node-extensibility, which might result in new entities to be created, as well as additional associations which might results in new data sources being part of join conditions. The presence of this annotation means the @Extensibility.Extensible annotation must be ignored." />
        </Property>
      </ComplexType>

      <Term Name="Annotations" Type="Extensibility.AnnotationsType" AppliesTo="EntityType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="The annotated entity type has the specified annotations extension capabilities" />
      </Term>

      <ComplexType Name="AnnotationsType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="Enable fine grained extensibility features" />
        <Property Name="Enabled" Type="Core.Tag" Nullable="false" DefaultValue="false">
          <Annotation Term="Common.Experimental" />
          <Annotation Term="Core.Description" String="Allows manipulating the annotations of the annotated entity and any of its attrirbutes, annotations define themselves if they can be overwritten. The presence of this annotation means the @Extensibility.Extensible annotation must be ignored." />
        </Property>
      </ComplexType>

      <Term Name="FieldExtensibilityMechanism" Type="Extensibility.FieldExtensibilityMechanismType" Nullable="false" AppliesTo="EntityContainer">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="The extension mechanism used by the annotated service" />
      </Term>

      <ComplexType Name="FieldExtensibilityMechanismType">
        <Annotation Term="Common.Experimental" />
        <Annotation Term="Core.Description" String="The extension mechanism used by the annotated service" />
        <Property Name="DiscoveryUrl" Type="Edm.String" Nullable="false">
          <Annotation Term="Common.Experimental" />
          <Annotation Term="Core.IsURL" Bool="true" />
          <Annotation Term="Core.Description" String="URL to discovery which field extensibility feature sets the backend supports and under which path the extensions can be created" />
          <Annotation Term="Core.LongDescription">
            <String>
              In the short run the server would return something like { "flavor" : "CAP", "path": "/add-cap-extension }
              In the future the frontend might use a more detailed protocol and the server response might look like
              { "feat1" : true, "feat2": true, "path": "/add-cap-extension } or can be delegated to another metadata discovery standard.
            </String>
          </Annotation>
        </Property>
      </ComplexType>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
